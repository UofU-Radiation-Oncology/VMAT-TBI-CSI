:begin template case configuration:
template name=regimen 1
%dose per fraction(cGy) and num fractions
initial dose per fraction=180
initial num fx=13
%boost dose per fraction and num fx
boost dose per fraction=180
boost num fx=17
%
add target{PTV_CSI,2340,CSI-init}
add target{PTV_Brain5400,5400,CSI-bst}
%
%
%create TS{CONTROL,TS_ring3800}
%create TS{CONTROL,TS_ring2500}
%create TS{CONTROL,TS_ring1800}
create TS{CONTROL,TS_ring900}
%create TS{CONTROL,Brainstem_PRV}
%create TS{CONTROL,Chiasm_PRV}
%create TS{CONTROL,Cochleas_PRV}
create TS{CONTROL,TS_Globes}
create TS{CONTROL,TS_Lenses}
create TS{CONTROL,TS_ArmsAvoid}
%
%add TS manipulation{Ovaries,Crop target from structure,1.5}
%add TS manipulation{Testes,Crop target from structure,2.0}
%add TS manipulation{Lenses,Dmax ~ Rx Dose,0.0}
%add TS manipulation{Chiasm,Crop target from structure,0.0}
%add TS manipulation{Lenses,Crop from Body,0.5}
%
crop and contour overlap with targets{Chiasm}
crop and contour overlap with targets{optic_nrvs}
crop and contour overlap with targets{Brainstem}
crop and contour overlap with targets{Globes}
%
%structure ID, constraint type, dose (cGy), volume (%), priority
add init opt constraint{TS_PTV_CSI,Lower,2340.0,100.0,100}
add init opt constraint{TS_PTV_CSI,Upper,2400.0,0.0,100}
add init opt constraint{TS_PTV_CSI,Lower,2350.0,98.0,100}
add init opt constraint{Brainstem,Upper,2440.0,0.0,80}
add init opt constraint{Chiasm,Upper,2440.0,0.0,80}
add init opt constraint{SpinalChord,Upper,2440.0,0.0,80}
add init opt constraint{optic_nrvs,Upper,2440.0,0.0,80}
add init opt constraint{Cochleas,Upper,2440.0,0.0,60}
add init opt constraint{Cochleas,Mean,2340.0,0.0,60}
add init opt constraint{Parotids,Mean,1000.0,0.0,60}
add init opt constraint{Pituitary,Upper,2440.0,0.0,60}
add init opt constraint{Globes,Upper,2440.0,0.0,60}
add init opt constraint{Globes,Mean,1950.0,0.0,60}
add init opt constraint{Lenses,Upper,1000.0,0.0,60}
add init opt constraint{Kidneys,Mean,500.0,0.0,80}
add init opt constraint{Ovaries,Mean,234.0,0.0,60}
add init opt constraint{Ovaries,Upper,500.0,0.0,60}
add init opt constraint{OralCavity,Mean,600.0,0.0,60}
add init opt constraint{Thyroid,Mean,1200.0,0.0,60}
add init opt constraint{Lungs,Mean,900.0,0.0,80}
add init opt constraint{Heart,Mean,780.0,0.0,50}
add init opt constraint{Esophagus,Mean,1200.0,0.0,50}
add init opt constraint{Submandibulars,Mean,450.0,0.0,50}
add init opt constraint{Larynx,Mean,1460.0,0.0,50}
add init opt constraint{TS_ring600,Upper,1200.0,0.0,80}
add init opt constraint{TS_ArmsAvoid,Upper,200.0,0.0,100}
add init opt constraint{TS_Globes,Upper,1200.0,0.0,50}
add init opt constraint{TS_Lenses,Upper,1000.0,0.0,50}
%
add boost opt constraint{TS_PTV_Brain5400,Lower,3060.0,100.0,100}
add boost opt constraint{TS_PTV_Brain5400,Upper,3100.0,0.0,100}
add boost opt constraint{TS_PTV_Brain5400,Lower,3070.0,98.0,100}
add boost opt constraint{Brainstem,Upper,3000.0,0.0,80}
add boost opt constraint{Chiasm,Upper,3000.0,0.0,80}
add boost opt constraint{Spinalcord,Upper,3000.0,10.0,80}
add boost opt constraint{Spinalcord,Upper,3000.0,0.0,80}
add boost opt constraint{Optic_NRV_L,Upper,3000.0,0.0,80}
add boost opt constraint{Optic_NRV_R,Upper,3000.0,0.0,80}
add boost opt constraint{Cochleas,Upper,3000.0,0.0,50}
add boost opt constraint{Cochleas,Mean,3000.0,0.0,50}
add boost opt constraint{Parotids,Mean,2600.0,0.0,50}
add boost opt constraint{Pituitary,Upper,3000.0,0.0,50}
add boost opt constraint{Hypothalamus,Upper,3000.0,0.0,50}
add boost opt constraint{Globes,Upper,3000.0,0.0,50}
add boost opt constraint{Globes,Mean,1000.0,0.0,50}
add boost opt constraint{Globes,Upper,3500.0,10.0,50}
add boost opt constraint{Lenses,Upper,1000.0,0.0,60}
add boost opt constraint{Kidneys,Mean,1000.0,0.0,50}
add boost opt constraint{Kidneys,Upper,2000.0,30.0,50}
add boost opt constraint{Ovaries,Upper,1000.0,0.0,50}
add boost opt constraint{Ovaries,Mean,500.0,0.0,50}
add boost opt constraint{Thyroid,Mean,2000.0,0.0,50}
add boost opt constraint{Heart,Mean,1000.0,0.0,50}
add boost opt constraint{Lungs,Mean,1200.0,0.0,60}
%
%plan objectives
%%NOTE: IT IS IMPORTANT THAT THE PTV STRUCTURE HAS THE ID ENTERED AS 'targetId'! THIS WILL BE OVERWRITTEN WITH THE 
%ACTUAL TARGET STRUCTURE ID AT RUNTIME
%structure ID, constraint type, dose (cGy), volume (%), dose value presentation
add plan objective{TS_PTV_Brain5400,Lower,100.0,95.0,Relative}
add plan objective{TS_PTV_Brain5400,Upper,110.0,0.0,Relative}
add plan objective{TS_PTV_CSI,Lower,2340.0,95.0,Absolute}
add plan objective{TS_PTV_CSIcrop,Upper,2600.0,0.0,Absolute}
add plan objective{Brainstem,Upper,104.0,0.0,Relative}
add plan objective{Chiasm,Upper,104.0,0.0,Relative}
add plan objective{SpinalChord,Upper,104.0,0.0,Relative}
add plan objective{optic_nrvs,Upper,104.0,0.0,Relative}
add plan objective{Cochleas,Upper,104.0,0.0,Relative}
add plan objective{Cochleas,Mean,100.0,0.0,Relative}
add plan objective{Parotids,Mean,33.3,0.0,Relative}
add plan objective{Pituitary,Upper,104.0,0.0,Relative}
add plan objective{Globes,Upper,104.0,0.0,Relative}
add plan objective{Globes,Mean,83.3,0.0,Relative}
add plan objective{Lenses,Upper,66.7,0.0,Relative}
add plan objective{Kidneys,Mean,20.8,0.0,Relative}
add plan objective{Ovaries,Mean,10.0,0.0,Relative}
add plan objective{Ovaries,Upper,20.8,0.0,Relative}
add plan objective{OralCavity,Mean,33.3,0.0,Relative}
add plan objective{Thyroid,Mean,50.0,0.0,Relative}
add plan objective{Lungs,Mean,20.8,0.0,Relative}
add plan objective{Heart,Mean,33.3,0.0,Relative}
add plan objective{Esophagus,Mean,79.2,0.0,Relative}
add plan objective{Submandibulars,Mean,37.5,0.0,Relative}
add plan objective{Larynx,Mean,62.5,0.0,Relative}
add plan objective{TS_ring600,Upper,50.0,0.0,Relative}
add plan objective{TS_ArmsAvoid,Upper,8.3,0.0,Relative}
add plan objective{TS_Globes,Upper,79.2,0.0,Relative}
add plan objective{TS_Lenses,Upper,50.0,0.0,Relative}
%
%be careful when adding these. It significantly slows down the plan quality evaluation at the end of each loop iteration
%(empty array indicates ts structure should always be added). All conditions are AND
%heater structures
%ID, lower dose level, upper dose level, volume (%), priority, conditions 
%add optimization TS structure{TS_heater90,90.0,100.0,100.0,60,{}}
%add optimization TS structure{TS_heater80,80.0,90.0,100.0,70,{Dmax>120}}
%add optimization TS structure{TS_heater70,70.0,80.0,100.0,80,{Dmax>130,V110>20.0}}
%
%heater structures
%ID, lower dose level, dose (%) to be used in optimization constraint, volume (%), priority, conditions 
add optimization TS structure{TS_cooler120,110.0,108.0,0.0,80,{Dmax>130}}
add optimization TS structure{TS_cooler110,110.0,108,0.0,80,{Dmax>120}}
add optimization TS structure{TS_cooler105,105.0,101.0,0.0,70,{finalOpt,Dmax>107,V110>10.0}}
add optimization TS structure{TS_cooler107,107.0,102.0,0.0,70,{finalOpt,Dmax>110}}
%
%additional plan dose info that should be printed after each iteration of the loop
%structure id (or can put '<plan>' to get the plan dose value), metric requested (Dmax, Dmin, D<vol %>, V<dose %>), return value representation (dose or volume as absolute or relative)
add plan dose info{<plan>,Dmax,Relative}
add plan dose info{<targetId>,Dmax,Relative}
add plan dose info{<targetId>,Dmin,Relative}
add plan dose info{<targetId>,D90,Relative}
add plan dose info{<targetId>,V90,Relative}
add plan dose info{<targetId>,V95,Relative}
add plan dose info{<targetId>,V110,Relative}
add plan dose info{<targetId>,V120,Relative}
%
:end template case configuration: